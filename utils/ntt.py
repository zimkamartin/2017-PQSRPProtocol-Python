from math import log2

ZETAS = [103343005, 1064867428, 542201251, 399454196, 490275507, 941528630, 35327516, 181277513, 91405032, 145462206, 214865857, 327254350, 196100517, 1045117713, 328986017, 406099526, 9981797, 709044286, 434824480, 961658272, 1043494371, 458895838, 563456335, 668491131, 264017316, 446427570, 449820565, 101449280, 371939559, 680182259, 1051704452, 662862592, 65488756, 93014439, 584409549, 545356560, 9269587, 254756344, 565012584, 31847132, 885506878, 426133215, 284214339, 118945294, 520317176, 730338555, 710501877, 16429582, 717915593, 360115636, 254450336, 701563406, 604365662, 882253415, 187302535, 862881203, 78237688, 278513684, 1037020984, 695148201, 71006940, 292488577, 562160550, 133081928, 396597888, 300894342, 481276821, 538847756, 225910050, 823443071, 609363992, 946453318, 401563452, 1040560942, 964680516, 831493811, 490293170, 256511161, 792917234, 563687194, 1037702773, 243567524, 16104025, 343142096, 1027352968, 319210467, 188775514, 38214889, 109104351, 303996489, 333758607, 145991318, 25315394, 16568523, 1001670944, 987910858, 143740275, 227979238, 507777504, 1069897201, 429209758, 728863862, 153222134, 397343912, 815645372, 652818108, 284667882, 62157670, 310187758, 100007835, 74888457, 141141600, 410332066, 1039081898, 264829189, 430912101, 906462769, 649827496, 21458318, 627449331, 578214456, 588855678, 789447622, 229210912, 248172666, 579113836, 905413473, 344292517, 938868613, 891943031, 880759427, 297191893, 177137874, 609534715, 934230911, 659315896, 606108639, 914071206, 679820293, 86338649, 376731186, 971268565, 1049813081, 206742651, 233554290, 457769820, 376360344, 153192134, 425447091, 344595601, 244193730, 276344996, 831008606, 261473343, 604692429, 152214511, 383846891, 109119065, 493517518, 366391882, 217268435, 413980438, 107459446, 158652502, 284434116, 490899138, 198602846, 481280870, 993833684, 386580677, 569964139, 953203655, 1061918617, 211556286, 579254920, 956226696, 344903437, 302774366, 92149529, 928924670, 949132984, 116336985, 262446621, 289994543, 132364301, 74145467, 1011613909, 1018714854, 861585451, 854417334, 829228104, 128975938, 693392158, 1043850374, 1061119307, 897197430, 166548748, 616467005, 21410026, 628242813, 729793274, 484941378, 895993458, 419391224, 200802968, 595756764, 932272714, 874031910, 742146223, 569543976, 414292050, 750362696, 102439639, 51443880, 32905860, 169051844, 186049022, 771971153, 785973303, 40202321, 707877240, 1011166921, 104820362, 264471771, 395695025, 424340754, 10025965, 417190927, 1038646033, 144646635, 589122678, 622482939, 7739825, 488864266, 683763711, 81160332, 713619099, 635017828, 605713424, 230424378, 921601756, 930618199, 259530493, 886009487, 231597689, 610008624, 44080948, 102803636, 654307602, 306492581, 632627404, 961142726, 172822709, 358271316, 434590705, 923256954, 254154577, 506787588, 199518404, 976928720, 554564844, 351296191, 1014826321, 929940700, 550320806, 490872744, 122007395, 833365923, 832984197, 767370558, 241265102, 288957042, 526336207, 497910358, 867972911, 66514423, 284409694, 223812351, 272177556, 742869121, 419259114, 12611444, 719474794, 423768950, 117656978, 999757041, 912985423, 50360685, 345031517, 964958875, 685881382, 74961773, 897305764, 147730850, 762440718, 77092117, 400519610, 368007911, 452133184, 295356176, 138582096, 85556401, 774849040, 435540559, 4047416, 580128797, 411866497, 271517792, 782079435, 880428499, 359817992, 886534282, 679732196, 927864749, 650645711, 624893421, 955215551, 146149353, 133386953, 622108414, 236788995, 791250846, 602999078, 168174667, 301483862, 378236569, 1006574999, 81842726, 167749062, 283538035, 893409119, 817196329, 296820413, 211073320, 299239655, 706135663, 157100104, 934659994, 1035993299, 710731854, 669017581, 1004631123, 1062326557, 934327313, 956496317, 141428400, 410490476, 408901204, 832060003, 866014983, 700550635, 502894179, 498638434, 442129816, 706234714, 873891813, 766660061, 609896879, 687246156, 864739405, 532835406, 149178442, 236531556, 222497507, 217702477, 652381031, 330726830, 1000864488, 901357641, 937919065, 948299332, 603923516, 405583240, 1019995785, 676230630, 1017459430, 469528592, 912654094, 900321109, 911367654, 384579864, 706566873, 981911407, 596705731, 640584315, 543884166, 178910531, 98212143, 923248128, 978137849, 712099961, 508073018, 964165642, 980057895, 446437452, 1039066555, 327066067, 310535050, 458604424, 873837555, 93571807, 289934840, 732065109, 473136994, 174718659, 134505865, 136238364, 756960539, 195802513, 918139467, 533060276, 961777002, 1001264551, 1039038216, 511914994, 312708701, 896570505, 1020734492, 982550410, 256756086, 11336227, 458786030, 698441524, 191841574, 677360641, 961577527, 243393002, 121332523, 981682408, 867604980, 1020440958, 446016366, 740196519, 280602323, 439339140, 423485709, 523274356, 602440300, 387396692, 68302850, 934164010, 323145394, 1066538532, 115348080, 337695265, 163389392, 821170243, 444138836, 1026992781, 341662136, 523482293, 7491258, 816433928, 480356174, 695982544, 863546604, 500773181, 645734959, 200993218, 263130248, 733429533, 750666038, 655741172, 601429441, 992411153, 670031939, 996691049, 6863690, 230988472, 676159305, 481825775, 1040396997, 803830018, 91525882, 752656672, 73255295, 72838112, 537768487, 588717495, 874865023, 632076901, 411289761, 385834082, 776157039, 1002157805, 500662838, 885962210, 152244722, 1040714865, 511811646, 277975936, 409331789, 763988890, 300675133, 556351723, 277939783, 1012037920, 871559740, 495617159, 501751218, 406716447, 781503453, 64356349, 1018437194, 968480621, 215498941, 417678281, 605565907, 803580557, 465056171, 364252720, 654459708, 842526398, 962771402, 926954681, 816310214, 899508283, 131558454, 1027342755, 233291477, 642501114, 932959884, 166314260, 162177363, 857518627, 553721972, 733585619, 1031948379, 265343206, 1055547070, 746583938, 505197555, 379537218, 867970745, 59264824, 270511214, 175838382, 324452340, 406029860, 909994406, 872202223, 473004706, 450426564, 294688240, 835001795, 429347072, 963576730, 51593860, 622129919, 372088336, 285766798, 674743329, 313958140, 216610704, 945188215, 1029647868, 587127053, 613778323, 238588439, 125137315, 774477852, 731658831, 835646959, 878987862, 293033968, 929907272, 642678488, 292811187, 133770317, 304532842, 52846596, 175331135, 1072443110, 928834039, 918802414, 223742123, 48609455, 905646094, 245176054, 151109322, 1065539841, 486169675, 744820180, 287923345, 697080339, 404815550, 345240310, 711260385, 406890887, 219994345, 587695950, 116717678, 260673125, 93138858, 890689472, 60276069, 502322423, 525415158, 386100295, 562413272, 417240543, 940820759, 205278445, 449957887, 760302321, 82186554, 126467022, 948172910, 717220956, 876242642, 367125388, 769964059, 20328591, 828029383, 94171552, 648359926, 832494807, 972091653, 1045476719, 150961686, 846719968, 7528071, 862380327, 985063703, 430936717, 231662425, 100070506, 298477321, 74991441, 244733846, 167888776, 838163351, 356984821, 271613833, 1009666756, 56233074, 287302302, 616530339, 974626094, 165442609, 273699299, 804657734, 529256908, 101491503, 615142709, 405728819, 715960485, 911181923, 567545239, 628929620, 360106597, 538738417, 199611539, 609992541, 363084175, 759596579, 839549683, 139764118, 472527747, 1015525743, 958301153, 401278636, 128965104, 883846900, 735964234, 736095463, 932719390, 519170207, 698219574, 883315282, 121002425, 376784891, 841008277, 901117935, 393852967, 410169217, 222920608, 805983459, 41720589, 759150751, 296874303, 393052571, 670331633, 748701493, 794829772, 688111889, 30888720, 695481938, 515218104, 814862001, 119163009, 928127260, 953558388, 742671293, 138727609, 514621353, 85380729, 569285634, 813223290, 893472086, 1024772033, 98653020, 1067333426, 53054897, 805705427, 937033696, 674162823, 693875409, 755713970, 1060270573, 1020819191, 3222250, 693103674, 308995719, 595906689, 573206197, 414031624, 809432675, 917381283, 620743953, 813236545, 16498439, 925425657, 927989212, 703752138, 180376016, 492788251, 357810604, 826298553, 1058899230, 13318967, 933263238, 552979414, 354354122, 478615170, 263575826, 274864138, 491273697, 749810230, 942497876, 556657715, 504047289, 552051013, 1048571467, 271230937, 824347131, 489340165, 327540190, 645413075, 209127019, 78864871, 14127670, 903492510, 734336608, 420273021, 765391350, 1019006126, 103323491, 640558653, 576828377, 106864148, 620474355, 789057861, 264762694, 484077177, 425244819, 446766794, 658103917, 842705178, 487230882, 182203786, 508538662, 787605609, 703905611, 446770879, 43728574, 200296364, 180489759, 551877486, 239704844, 40919808, 722119242, 168211615, 380906536, 443349999, 798022493, 730743424, 689002669, 398938975, 258277005, 419447290, 384692124, 1044762975, 588240606, 225867929, 638992562, 209134318, 1008367073, 170946543, 1005084934, 1050188030, 464645243, 42431000, 889209937, 568359944, 1030833118, 542491946, 178436694, 419927204, 1042396351, 628491404, 952616093, 106466662, 362175334, 865764612, 623754452, 534215108, 514287174, 232631173, 421708529, 153237328, 751945458, 967113161, 186428397, 776815444, 387306214, 731424261, 898836510, 293217381, 530309095, 79747545, 661228713, 265171299, 958833281, 568487566, 823810059, 1003774782, 495233150, 449079778, 701245668, 1007605924, 741916570, 741787488, 340840930, 336105506, 677294091, 574304690, 786524517, 389622723, 98223916, 518528836, 1070915052, 775209331, 684117119, 265611357, 39001601, 1057554688, 936511834, 915744374, 545762111, 1017434115, 933170454, 809844642, 804453951, 552462965, 382224635, 115483956, 415942057, 702213115, 826646145, 290960739, 248099046, 132317941, 224359403, 8526480, 631496147, 960135080, 127289099, 265726082, 697383005, 349070303, 572741340, 844102478, 925756657, 952361307, 1019925673, 273150440, 72286093, 371814098, 902935837, 470389905, 376765143, 973797436, 436135289, 897819421, 739673908, 982418579, 681488990, 66868554, 86536042, 525323264, 577910290, 242470138, 754223160, 434550883, 604909021, 668695909, 278026195, 140276418, 78667362, 895272673, 456410922, 367300414, 135659358, 328028225, 1043657468, 955685986, 11181447, 326310914, 88056861, 532938017, 730317616, 474646676, 330775900, 497856344, 503242570, 160804538, 838816887, 1030478937, 435022958, 27753872, 808938727, 882224111, 608862583, 498628785, 282295875, 593286577, 670063428, 545719715, 310065498, 871267941, 224403738, 981157994, 785592477, 92665836, 614992314, 330923954, 916351429, 475104893, 226196844, 81368684, 818266169, 709136446, 267720817, 413734018, 467495495, 672372692, 881660359, 201048482, 342979938, 831057667, 370553474, 179442548, 99651271, 206593271, 716176407, 1061554199, 650839549, 548538883, 307938458, 215824452, 820333235, 986283711, 849530492, 30102821, 507399974, 311172148, 271647482, 621578270, 449812091, 396256785, 421374936, 929828659, 434047979, 484567107, 1022726032, 1072732754, 559677986, 128495329, 403881265, 181718552, 309167426, 497674084, 222229127, 992346061, 638537917, 530964535, 470998495, 752161003, 1059176158, 409925787, 528446155, 831052662, 236931922, 1026106192, 245289502, 655678229, 947227065, 415952045, 583623285, 967454629, 615454919, 757689264, 480868710, 246512085, 609075367, 991918150, 1002050996, 742263645, 616499172, 353540248, 239133301, 13018541]
ZETAS_INVERTED = [970136676, 531278430, 8612253, 1038152165, 131951051, 583204174, 674025485, 744493664, 28361968, 877379164, 746225331, 858613824, 928017475, 982074649, 892202168, 21775229, 393297422, 701540122, 972030401, 623659116, 627052111, 809462365, 404988550, 510023346, 614583843, 29985310, 111821409, 638655201, 364435395, 1063497884, 667380155, 511319131, 780991104, 1002472741, 378331480, 36458697, 794965997, 995241993, 210598478, 886177146, 191226266, 469114019, 371916275, 819029345, 713364045, 355564088, 1057050099, 362977804, 343141126, 553162505, 954534387, 789265342, 647346466, 187972803, 1041632549, 508467097, 818723337, 1064210094, 528123121, 489070132, 980465242, 1007990925, 410617089, 168066208, 494365845, 825307015, 844268769, 284032059, 484624003, 495265225, 446030350, 1052021363, 423652185, 167016912, 642567580, 808650492, 34397783, 663147615, 932338081, 998591224, 973471846, 763291923, 1011322011, 788811799, 420661573, 257834309, 676135769, 920257547, 344615819, 644269923, 3582480, 565702177, 845500443, 929739406, 85568823, 71808737, 1056911158, 1048164287, 927488363, 739721074, 769483192, 964375330, 1035264792, 884704167, 754269214, 46126713, 730337585, 1057375656, 829912157, 35776908, 509792487, 280562447, 816968520, 583186511, 241985870, 108799165, 32918739, 671916229, 127026363, 464115689, 250036610, 847569631, 534631925, 592202860, 772585339, 676881793, 940397753, 638888976, 715208365, 900656972, 112336955, 440852277, 766987100, 419172079, 970676045, 1029398733, 463471057, 841881992, 187470194, 813949188, 142861482, 151877925, 843055303, 467766257, 438461853, 359860582, 992319349, 389715970, 584615415, 1065739856, 450996742, 484357003, 928833046, 34833648, 656288754, 1063453716, 649138927, 677784656, 809007910, 968659319, 62312760, 365602441, 1033277360, 287506378, 301508528, 887430659, 904427837, 1040573821, 1022035801, 971040042, 323116985, 659187631, 503935705, 331333458, 199447771, 141206967, 477722917, 872676713, 654088457, 177486223, 588538303, 343686407, 445236868, 1052069655, 457012676, 906930933, 176282251, 12360374, 29629307, 380087523, 944503743, 244251577, 219062347, 211894230, 54764827, 61865772, 999334214, 941115380, 783485138, 811033060, 957142696, 124346697, 144555011, 981330152, 770705315, 728576244, 117252985, 494224761, 861923395, 11561064, 120276026, 503515542, 686899004, 79645997, 592198811, 874876835, 582580543, 789045565, 914827179, 966020235, 659499243, 856211246, 707087799, 579962163, 964360616, 689632790, 921265170, 468787252, 812006338, 242471075, 797134685, 829285951, 728884080, 648032590, 920287547, 697119337, 615709861, 839925391, 866737030, 23666600, 102211116, 696748495, 987141032, 393659388, 159408475, 467371042, 414163785, 139248770, 463944966, 896341807, 776287788, 192720254, 181536650, 134611068, 729187164, 709226961, 608423510, 269899124, 467913774, 655801400, 857980740, 104999060, 55042487, 1009123332, 291976228, 666763234, 571728463, 577862522, 201919941, 61441761, 795539898, 517127958, 772804548, 309490791, 664147892, 795503745, 561668035, 32764816, 921234959, 187517471, 572816843, 71321876, 297322642, 687645599, 662189920, 441402780, 198614658, 484762186, 535711194, 1000641569, 1000224386, 320823009, 981953799, 269649663, 33082684, 591653906, 397320376, 842491209, 1066615991, 76788632, 403447742, 81068528, 472050240, 417738509, 322813643, 340050148, 810349433, 872486463, 427744722, 572706500, 209933077, 377497137, 593123507, 257045753, 1065988423, 549997388, 731817545, 46486900, 629340845, 252309438, 910090289, 735784416, 958131601, 6941149, 750334287, 139315671, 1005176831, 686082989, 471039381, 550205325, 649993972, 634140541, 792877358, 333283162, 627463315, 53038723, 205874701, 91797273, 952147158, 830086679, 111902154, 396119040, 881638107, 375038157, 614693651, 1062143454, 816723595, 90929271, 52745189, 176909176, 760770980, 561564687, 34441465, 72215130, 111702679, 540419405, 155340214, 877677168, 316519142, 937241317, 938973816, 898761022, 600342687, 341414572, 783544841, 979907874, 199642126, 614875257, 762944631, 746413614, 34413126, 627042229, 93421786, 109314039, 565406663, 361379720, 95341832, 150231553, 975267538, 894569150, 529595515, 432895366, 476773950, 91568274, 366912808, 688899817, 162112027, 173158572, 160825587, 603951089, 56020251, 397249051, 53483896, 667896441, 469556165, 125180349, 135560616, 172122040, 72615193, 742752851, 421098650, 855777204, 850982174, 836948125, 924301239, 540644275, 208740276, 386233525, 463582802, 306819620, 199587868, 367244967, 631349865, 574841247, 570585502, 372929046, 207464698, 241419678, 664578477, 662989205, 932051281, 116983364, 139152368, 11153124, 68848558, 404462100, 362747827, 37486382, 138819687, 916379577, 367344018, 774240026, 862406361, 776659268, 256283352, 180070562, 789941646, 905730619, 991636955, 66904682, 695243112, 771995819, 905305014, 470480603, 282228835, 836690686, 451371267, 940092728, 927330328, 118264130, 448586260, 422833970, 145614932, 393747485, 186945399, 713661689, 193051182, 291400246, 801961889, 661613184, 493350884, 1069432265, 637939122, 298630641, 987923280, 934897585, 778123505, 621346497, 705471770, 672960071, 996387564, 311038963, 925748831, 176173917, 998517908, 387598299, 108520806, 728448164, 1023118996, 160494258, 73722640, 955822703, 649710731, 354004887, 1060868237, 654220567, 330610560, 801302125, 849667330, 789069987, 1006965258, 205506770, 575569323, 547143474, 784522639, 832214579, 306109123, 240495484, 240113758, 951472286, 582606937, 523158875, 143538981, 58653360, 722183490, 518914837, 96550961, 873961277, 566692093, 819325104, 150222727, 1060461140, 834346380, 719939433, 456980509, 331216036, 71428685, 81561531, 464404314, 826967596, 592610971, 315790417, 458024762, 106025052, 489856396, 657527636, 126252616, 417801452, 828190179, 47373489, 836547759, 242427019, 545033526, 663553894, 14303523, 321318678, 602481186, 542515146, 434941764, 81133620, 851250554, 575805597, 764312255, 891761129, 669598416, 944984352, 513801695, 746927, 50753649, 588912574, 639431702, 143651022, 652104745, 677222896, 623667590, 451901411, 801832199, 762307533, 566079707, 1043376860, 223949189, 87195970, 253146446, 857655229, 765541223, 524940798, 422640132, 11925482, 357303274, 866886410, 973828410, 894037133, 702926207, 242422014, 730499743, 872431199, 191819322, 401106989, 605984186, 659745663, 805758864, 364343235, 255213512, 992110997, 847282837, 598374788, 157128252, 742555727, 458487367, 980813845, 287887204, 92321687, 849075943, 202211740, 763414183, 527759966, 403416253, 480193104, 791183806, 574850896, 464617098, 191255570, 264540954, 1045725809, 638456723, 43000744, 234662794, 912675143, 570237111, 575623337, 742703781, 598833005, 343162065, 540541664, 985422820, 747168767, 1062298234, 117793695, 29822213, 745451456, 937820323, 706179267, 617068759, 178207008, 994812319, 933203263, 795453486, 404783772, 468570660, 638928798, 319256521, 831009543, 495569391, 548156417, 986943639, 1006611127, 391990691, 91061102, 333805773, 175660260, 637344392, 99682245, 696714538, 603089776, 170543844, 701665583, 1001193588, 800329241, 53554008, 121118374, 147723024, 229377203, 500738341, 724409378, 376096676, 807753599, 946190582, 113344601, 441983534, 1064953201, 849120278, 941161740, 825380635, 782518942, 246833536, 371266566, 657537624, 957995725, 691255046, 521016716, 269025730, 263635039, 140309227, 56045566, 527717570, 157735307, 136967847, 15924993, 1034478080, 807868324, 389362562, 298270350, 2564629, 554950845, 975255765, 683856958, 286955164, 499174991, 396185590, 737374175, 732638751, 331692193, 331563111, 65873757, 372234013, 624399903, 578246531, 69704899, 249669622, 504992115, 114646400, 808308382, 412250968, 993732136, 543170586, 780262300, 174643171, 342055420, 686173467, 296664237, 887051284, 106366520, 321534223, 920242353, 651771152, 840848508, 559192507, 539264573, 449725229, 207715069, 711304347, 967013019, 120863588, 444988277, 31083330, 653552477, 895042987, 530987735, 42646563, 505119737, 184269744, 1031048681, 608834438, 23291651, 68394747, 902533138, 65112608, 864345363, 434487119, 847611752, 485239075, 28716706, 688787557, 654032391, 815202676, 674540706, 384477012, 342736257, 275457188, 630129682, 692573145, 905268066, 351360439, 1032559873, 833774837, 521602195, 892989922, 873183317, 1029751107, 626708802, 369574070, 285874072, 564941019, 891275895, 586248799, 230774503, 415375764, 626712887, 648234862, 589402504, 808716987, 284421820, 453005326, 966615533, 496651304, 432921028, 970156190, 54473555, 308088331, 653206660, 339143073, 169987171, 1059352011, 994614810, 864352662, 428066606, 745939491, 584139516, 249132550, 802248744, 24908214, 521428668, 569432392, 516821966, 130981805, 323669451, 582205984, 798615543, 809903855, 594864511, 719125559, 520500267, 140216443, 1060160714, 14580451, 247181128, 715669077, 580691430, 893103665, 369727543, 145490469, 148054024, 1056981242, 260243136, 452735728, 156098398, 264047006, 659448057, 500273484, 477572992, 764483962, 380376007, 1070257431, 52660490, 13209108, 317765711, 379604272, 399316858, 136445985, 267774254, 1020424784, 6146255, 974826661, 48707648, 180007595, 260256391, 504194047, 988098952, 558858328, 934752072, 330808388, 119921293, 145352421, 954316672, 258617680, 558261577, 377997743, 1042590961, 385367792, 278649909, 324778188, 403148048, 680427110, 776605378, 314328930, 1031759092, 267496222, 850559073, 663310464, 679626714, 172361746, 232471404, 696694790, 952477256, 190164399, 375260107, 554309474, 140760291, 337384218, 337515447, 189632781, 944514577, 672201045, 115178528, 57953938, 600951934, 933715563, 233929998, 313883102, 710395506, 463487140, 873868142, 534741264, 713373084, 444550061, 505934442, 162297758, 357519196, 667750862, 458336972, 971988178, 544222773, 268821947, 799780382, 908037072, 98853587, 456949342, 786177379, 1017246607, 63812925, 801865848, 716494860, 235316330, 905590905, 828745835, 998488240, 775002360, 973409175, 841817256, 642542964, 88415978, 211099354, 1065951610, 226759713, 922517995, 28002962, 101388028, 240984874, 425119755, 979308129, 245450298, 1053151090, 303515622, 706354293, 197237039, 356258725, 125306771, 947012659, 991293127, 313177360, 623521794, 868201236, 132658922, 656239138, 511066409, 687379386, 548064523, 571157258, 1013203612, 182790209, 980340823, 812806556, 956762003, 485783731, 853485336, 666588794, 362219296, 728239371, 668664131, 376399342, 785556336, 328659501, 587310006, 7939840, 922370359, 828303627, 167833587, 1024870226, 849737558, 154677267, 144645642, 1036571, 898148546, 1020633085, 768946839, 939709364, 780668494, 430801193, 143572409, 780445713, 194491819, 237832722, 341820850, 299001829, 948342366, 834891242, 459701358, 486352628, 43831813, 128291466, 856868977, 759521541, 398736352, 787712883, 701391345, 451349762, 1021885821, 109902951, 644132609, 238477886, 778791441, 623053117, 600474975, 201277458, 163485275, 667449821, 749027341, 897641299, 802968467, 1014214857, 205508936, 693942463, 568282126, 326895743, 17932611, 808136475, 41531302, 339894062, 519757709, 215961054, 911302318, 907165421, 140519797, 430978567, 840188204, 46136926, 941921227, 173971398, 257169467, 146525000, 110708279, 230953283, 419019973]


def convert_to_ntt(input_poly, q):
    poly_ntt = input_poly.copy()  # input array
    poly_len = len(poly_ntt)  # length of an input array
    zeta_index = 0  # which zeta from zetas are we using

    for layer in range(int(log2(poly_len))):  # number of layers in NTT tree
        num_of_subpolys = 2 ** layer  # number of sub-polynomials that we want to module in this layer
        len_of_subpoly = poly_len // num_of_subpolys  # length of sub-polynomials that we want to module in this layer
        for subpoly_counter in range(num_of_subpolys):
            poly_lst_index = subpoly_counter * len_of_subpoly - 1  # index of an input array that was lastly used
            for subpoly_index in range(poly_lst_index + 1, poly_lst_index + 1 + len_of_subpoly // 2):
                subpoly_half_index = subpoly_index + len_of_subpoly // 2  # half index of a sub-polynomial that will be used with subpoly_index when moduling
                old_subpoly_coeff = poly_ntt[subpoly_index]
                old_subpoly_half_coeff = poly_ntt[subpoly_half_index]
                poly_ntt[subpoly_index] = (old_subpoly_coeff - ZETAS[zeta_index] * old_subpoly_half_coeff) % q
                poly_ntt[subpoly_half_index] = (old_subpoly_coeff + ZETAS[zeta_index] * old_subpoly_half_coeff) % q
            zeta_index += 1
    
    return poly_ntt


def multiply_ntt_polys(poly_a, poly_b, q):
    return [a * b % q for (a, b) in zip(poly_a, poly_b)]


def convert_from_ntt(input_poly, q):
    poly = input_poly.copy()  # input array
    poly_len = len(poly)  # length of an input array
    zeta_index = len(ZETAS_INVERTED) - 1  # which zeta from zetas are we using

    num_of_layers = int(log2(poly_len))
    for layer in range(num_of_layers - 1, -1, -1):  # number of layers in NTT tree
        num_of_subpolys = 2 ** layer  # number of sub-polynomials that we want to module in this layer
        len_of_subpoly = poly_len // num_of_subpolys  # length of sub-polynomials that we want to module in this layer
        for subpoly_counter in range(num_of_subpolys - 1, -1, -1):
            poly_lst_index = subpoly_counter * len_of_subpoly + len_of_subpoly  # index of an input array that was lastly used
            for subpoly_half_index in range(poly_lst_index - 1, poly_lst_index - 1 - len_of_subpoly // 2, -1):
                subpoly_index = subpoly_half_index - len_of_subpoly // 2  # half index of a sub-polynomial that will be used with subpoly_index when moduling
                old_subpoly_coeff = poly[subpoly_index]
                old_subpoly_half_coeff = poly[subpoly_half_index]
                poly[subpoly_index] = (old_subpoly_coeff + old_subpoly_half_coeff) % q
                poly[subpoly_half_index] = (- ZETAS_INVERTED[zeta_index] * (old_subpoly_coeff - old_subpoly_half_coeff)) % q
            zeta_index -= 1
    
    two_divisor = pow(2, -num_of_layers, q)
    return [(coeff * two_divisor) % q for coeff in poly]